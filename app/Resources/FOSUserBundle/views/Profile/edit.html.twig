{% extends 'SyliusWebBundle:Frontend:layout.html.twig' %}

{% trans_default_domain 'FOSUserBundle' %}

{% block html %} ng-app="register"{% endblock %}

{% block border %}
{% endblock %}

{% block content %}
    <form name="form" action="{{ path('fos_user_profile_edit') }}" method="post" class="form-horizontal registerForm profileEditForm" ng-submit="submit" ng-controller="RegisterController as reg" novalidate>
        <fieldset class="well">
            {{ 'registration.register_headerProfileEdit'|trans|raw }}
            <hr>
            <div class="left">
                <div class="form-group">
                    {{ form_label(form.firstName) }}
                    <span class="valid"></span>{{ form_widget(form.firstName, { 'attr': {'class': 'form-control', 'ng-model' : 'user.firstName', 'ng-minlength' : '2', 'ng-maxlength' : '255'}, 'required' : 'required'  }) }}<span>*</span>
                </div>
                <div class="form-group">
                    {{ form_label(form.city) }}
                    <span class="valid"></span>{{ form_widget(form.city, { 'attr': {'class': 'form-control', 'ng-model' : 'user.city'}, 'required' : 'required' }) }}<span>*</span>
                </div>
                <div class="form-group">
                    {{ form_label(form.email, '') }}
                    <span class="valid"></span>{{ form_widget(form.email, { 'attr': {'class': 'form-control', 'ng-model' : 'user.email'}, 'required' : 'required' }) }}<span>*</span>
                </div>
                <div class="form-group">
                    {{ form_label(form.phone, '') }}
                    <span class="valid"></span>{{ form_widget(form.phone, { 'attr': {'class': 'form-control', 'ng-model' : 'user.phone'} }) }}<span>*</span>
                </div>
                <div class="form-group">
                    {{ form_label(form.address, '') }}
                    <span class="valid"></span>{{ form_widget(form.address, { 'attr': {'class': 'form-control'} }) }}
                </div>
            </div>
            <div class="form-actions clearfix">
                <button type="submit" class="btn btn-success btn-lg" ng-disabled="form.$invalid">{{ 'registration.submit'|trans }}</button>
            </div>
            {{ form_errors(form) }}
            {#<div class="alert alert-danger" ng-show="user.firstName.$error.required">{{ 'registration.first_name.not_blank'|trans }}</div>#}
            {#<div class="alert alert-danger" ng-show="user.firstName.$error.min">{{ 'registration.first_name.min'|trans }}</div>#}
            {#<div class="alert alert-danger" ng-show="user.firstName.$error.max">{{ 'registration.first_name.max'|trans }}</div>#}
        </fieldset>
        {{ form_end(form) }}
    </form>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript" src="{{ asset("js/jquery.maskedinput.js") }}"></script>
    <script type="text/javascript" src="{{ asset("js/angular.min.js") }}"></script>
    {% if is_granted('ROLE_USER') %}
        {% set user = app.security.getToken().getUser() %}
        <script type="text/javascript">
            window.user = {
                firstName: '{{ user.firstName }}',
                city: '{{ user.city}}',
                email: '{{ user.email }}',
                phone: '{{ user.phone }}',
                address : '{{ user.address }}'
            };
        </script>
    {% endif %}
    <script type="text/javascript" src="{{ asset("js/register.js") }}"></script>
{% endblock %}
